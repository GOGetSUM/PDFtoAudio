
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.3.1, mkdocs-material-8.4.2">
    
    
      
        <title>Explanation - PDF2Audio Docs</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.69437709.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.cbb835fc.min.css">
        
      
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#pdf_audio_main" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="PDF2Audio Docs" class="md-header__button md-logo" aria-label="PDF2Audio Docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            PDF2Audio Docs
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Explanation
            
          </span>
        </div>
      </div>
    </div>
    
    
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="PDF2Audio Docs" class="md-nav__button md-logo" aria-label="PDF2Audio Docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    PDF2Audio Docs
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        PDF 2 Audio
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../reference/" class="md-nav__link">
        Reference
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Explanation
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Explanation
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#pdf_audio_main" class="md-nav__link">
    pdf_audio_main
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pdf_audio_main.PDF_Manipulation" class="md-nav__link">
    PDF_Manipulation
  </a>
  
    <nav class="md-nav" aria-label="PDF_Manipulation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pdf_audio_main.PDF_Manipulation.create_speech" class="md-nav__link">
    create_speech()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pdf_audio_main.PDF_Manipulation.create_text" class="md-nav__link">
    create_text()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#pdf_audio_main" class="md-nav__link">
    pdf_audio_main
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pdf_audio_main.PDF_Manipulation" class="md-nav__link">
    PDF_Manipulation
  </a>
  
    <nav class="md-nav" aria-label="PDF_Manipulation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pdf_audio_main.PDF_Manipulation.create_speech" class="md-nav__link">
    create_speech()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pdf_audio_main.PDF_Manipulation.create_text" class="md-nav__link">
    create_text()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                


  <h1>Explanation</h1>

<p>This part of the project documentation focuses source code, class and 
methods for 
<code>pdf_audio_main</code> project code.</p>


<div class="doc doc-object doc-module">


<a id="pdf_audio_main"></a>
  <div class="doc doc-contents first">

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="pdf_audio_main.PDF_Manipulation" class="doc doc-heading">
        <code>PDF_Manipulation</code>


</h2>


  <div class="doc doc-contents ">

  
      <p>PDF Manipulation class creates text from a pdf and also creates audio from a txt script.</p>
<p>There are two methods in this class, first is create_text() which takes in an PDF file path and fetches
the text from this PDF file, Out-put is a .txt file.
Second method is create_speech() where a given script as a .txt file is given and the method creates an
audio mp3 file.</p>

  <p><strong>Attributes:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>create_text()</code></td>
          <td>
          </td>
          <td><p>Asks for PDF filepath from user and returns script text as printed on console and save (.txt)</p></td>
        </tr>
        <tr>
          <td><code>create_speech(text)</code></td>
          <td>
          </td>
          <td><p>Uses given argument text and returns audio, auto plays audio and saves .mp3</p></td>
        </tr>
    </tbody>
  </table>

<details class="typical-usage-example">
  <summary>Typical usage example</summary>
  <p>create_text()
create_speech(text)</p>
</details>

        <details class="quote">
          <summary>Source code in <code>PDFtoAudio\pdf_audio_main.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">  9</span>
<span class="normal"> 10</span>
<span class="normal"> 11</span>
<span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">PDF_Manipulation</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot; PDF Manipulation class creates text from a pdf and also creates audio from a txt script.</span>

<span class="sd">    There are two methods in this class, first is create_text() which takes in an PDF file path and fetches</span>
<span class="sd">    the text from this PDF file, Out-put is a .txt file.</span>
<span class="sd">    Second method is create_speech() where a given script as a .txt file is given and the method creates an</span>
<span class="sd">    audio mp3 file.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        create_text(): Asks for PDF filepath from user and returns script text as printed on console and save (.txt)</span>
<span class="sd">        create_speech(text): Uses given argument text and returns audio, auto plays audio and saves .mp3</span>
<span class="sd">        file to location.</span>

<span class="sd">    Typical usage example:</span>
<span class="sd">        create_text()</span>
<span class="sd">        create_speech(text)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">create_text</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">create_speech</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">create_text</span><span class="p">(</span><span class="n">speech</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">playback</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">-&gt;</span><span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Fetches text from PDF, outputs str on console and saves .txt file in location of filepath provided.</span>

<span class="sd">        On user input for file path to pdf, create_text() fetches text from given pdf file path.</span>

<span class="sd">        Args:</span>
<span class="sd">            speech:</span>
<span class="sd">                Bool input if True method create_speech(text) will be executed using given text,</span>
<span class="sd">                If false create_speech(text) will not be executed.</span>

<span class="sd">            playback:</span>
<span class="sd">                Bool input used in nested method call create_speech() if True create_speech() will playback audio.</span>
<span class="sd">                Else create_speech() will only save mp3 file to project folder location MP3.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A string printed onto the console based on txt found in pdf file. It also saves a .txt file named</span>
<span class="sd">            &quot;input pdf&quot;_Script to location Scripts.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># initialize pytesseract and pdf2image</span>
        <span class="n">poppler_path</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;C:\Program Files\poppler-0.68.0\bin&#39;</span>
        <span class="n">pytesseract</span><span class="o">.</span><span class="n">pytesseract</span><span class="o">.</span><span class="n">tesseract_cmd</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;C:\Program Files\Tesseract-OCR\tesseract.exe&#39;</span>


        <span class="n">filePath</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s1">&#39;Please provide file path to PDF location:&#39;</span><span class="p">)</span> <span class="c1"># User input for file path.</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;File Path provide: </span><span class="si">{</span><span class="n">filePath</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="n">images</span> <span class="o">=</span>  <span class="n">convert_from_path</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">filePath</span><span class="p">[:</span><span class="o">-</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s1">pdf&#39;</span><span class="p">,</span><span class="n">poppler_path</span><span class="o">=</span><span class="n">poppler_path</span><span class="p">)</span> <span class="c1">#converts pdf to image</span>

        <span class="n">text</span> <span class="o">=</span> <span class="n">pytesseract</span><span class="o">.</span><span class="n">image_to_string</span><span class="p">(</span><span class="n">images</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># extract text using pytesseract</span>

        <span class="c1"># Creates and opens a text file, writes extracted text and closes file in location.</span>
        <span class="c1"># Prints text script to console</span>
        <span class="n">text_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">filePath</span><span class="p">[:</span><span class="o">-</span><span class="mi">4</span><span class="p">]</span><span class="si">}</span><span class="s1">_Script.txt&#39;</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
        <span class="n">text_</span> <span class="o">=</span> <span class="n">text</span>
        <span class="n">text_</span> <span class="o">=</span> <span class="n">text_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">text_</span><span class="p">)</span>
        <span class="n">text_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">text</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">speech</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">playback</span><span class="p">:</span>
                <span class="n">PDF_Manipulation</span><span class="o">.</span><span class="n">create_speech</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="n">text</span><span class="p">,</span><span class="n">playback</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">PDF_Manipulation</span><span class="o">.</span><span class="n">create_speech</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="n">text</span><span class="p">)</span>






    <span class="k">def</span> <span class="nf">create_speech</span><span class="p">(</span><span class="n">text</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">playback</span> <span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Creates Audio mp3 file based on text argument.</span>

<span class="sd">        Leveraging the AWS Polly a cloud based service that converts text into spoken audio.</span>
<span class="sd">        VoiceID is set to Russell but can be change to any acceptable Voice ID per AWS polly.</span>
<span class="sd">        Output Format is set to mp3 but can be change to any acceptable AWS polly output format.</span>

<span class="sd">        Args:</span>
<span class="sd">            text:</span>
<span class="sd">                Any string formated text script.</span>
<span class="sd">            playback:</span>
<span class="sd">                Bool input if True create_speech() will playback audio.</span>
<span class="sd">                Else create_speech() will only save mp3 file to project folder location MP3.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Playback in audio form of given text input.</span>
<span class="sd">            MP3 file save to location, MP3 folder. Please note &#39;OUTPUT.MP3&#39; will be overwritten each time</span>
<span class="sd">            create_speech() is executed.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Activate polly - settings for OutputFormat and VoiceID</span>
        <span class="n">polly</span> <span class="o">=</span> <span class="n">client</span><span class="p">(</span><span class="s1">&#39;polly&#39;</span><span class="p">)</span>
        <span class="n">spoken_text</span> <span class="o">=</span> <span class="n">polly</span><span class="o">.</span><span class="n">synthesize_speech</span><span class="p">(</span><span class="n">Text</span><span class="o">=</span><span class="n">text</span><span class="p">,</span>
                                                        <span class="n">OutputFormat</span><span class="o">=</span><span class="s1">&#39;mp3&#39;</span><span class="p">,</span>
                                                        <span class="n">VoiceId</span><span class="o">=</span><span class="s1">&#39;Russell&#39;</span><span class="p">)</span>

        <span class="c1"># Creates mp3 file and writes audiostream to the file</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;MP3\OUTPUT.mp3&#39;</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">spoken_text</span><span class="p">[</span><span class="s1">&#39;AudioStream&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>

        <span class="c1"># Leverages pygame to playback audio if playback argument is True.</span>
        <span class="k">if</span> <span class="n">playback</span><span class="p">:</span>
            <span class="n">pygame</span><span class="o">.</span><span class="n">mixer</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
            <span class="n">pygame</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
            <span class="n">sound</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">mixer</span><span class="o">.</span><span class="n">Sound</span><span class="p">(</span><span class="s1">&#39;MP3\OUTPUT.mp3&#39;</span><span class="p">)</span>
            <span class="n">sound_length</span> <span class="o">=</span> <span class="n">sound</span><span class="o">.</span><span class="n">get_length</span><span class="p">()</span>
            <span class="n">sound</span><span class="o">.</span><span class="n">play</span><span class="p">()</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">sound_length</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h3 id="pdf_audio_main.PDF_Manipulation.create_speech" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create_speech</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">playback</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Creates Audio mp3 file based on text argument.</p>
<p>Leveraging the AWS Polly a cloud based service that converts text into spoken audio.
VoiceID is set to Russell but can be change to any acceptable Voice ID per AWS polly.
Output Format is set to mp3 but can be change to any acceptable AWS polly output format.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>text</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>Any string formated text script.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>playback</code></td>
          <td>
          </td>
          <td><p>Bool input if True create_speech() will playback audio.
Else create_speech() will only save mp3 file to project folder location MP3.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
          </td>
          <td><p>Playback in audio form of given text input.</p></td>
        </tr>
        <tr>
          <td>
          </td>
          <td><p>MP3 file save to location, MP3 folder. Please note 'OUTPUT.MP3' will be overwritten each time</p></td>
        </tr>
        <tr>
          <td>
          </td>
          <td><p>create_speech() is executed.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>PDFtoAudio\pdf_audio_main.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">create_speech</span><span class="p">(</span><span class="n">text</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">playback</span> <span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Creates Audio mp3 file based on text argument.</span>

<span class="sd">    Leveraging the AWS Polly a cloud based service that converts text into spoken audio.</span>
<span class="sd">    VoiceID is set to Russell but can be change to any acceptable Voice ID per AWS polly.</span>
<span class="sd">    Output Format is set to mp3 but can be change to any acceptable AWS polly output format.</span>

<span class="sd">    Args:</span>
<span class="sd">        text:</span>
<span class="sd">            Any string formated text script.</span>
<span class="sd">        playback:</span>
<span class="sd">            Bool input if True create_speech() will playback audio.</span>
<span class="sd">            Else create_speech() will only save mp3 file to project folder location MP3.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Playback in audio form of given text input.</span>
<span class="sd">        MP3 file save to location, MP3 folder. Please note &#39;OUTPUT.MP3&#39; will be overwritten each time</span>
<span class="sd">        create_speech() is executed.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Activate polly - settings for OutputFormat and VoiceID</span>
    <span class="n">polly</span> <span class="o">=</span> <span class="n">client</span><span class="p">(</span><span class="s1">&#39;polly&#39;</span><span class="p">)</span>
    <span class="n">spoken_text</span> <span class="o">=</span> <span class="n">polly</span><span class="o">.</span><span class="n">synthesize_speech</span><span class="p">(</span><span class="n">Text</span><span class="o">=</span><span class="n">text</span><span class="p">,</span>
                                                    <span class="n">OutputFormat</span><span class="o">=</span><span class="s1">&#39;mp3&#39;</span><span class="p">,</span>
                                                    <span class="n">VoiceId</span><span class="o">=</span><span class="s1">&#39;Russell&#39;</span><span class="p">)</span>

    <span class="c1"># Creates mp3 file and writes audiostream to the file</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;MP3\OUTPUT.mp3&#39;</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">spoken_text</span><span class="p">[</span><span class="s1">&#39;AudioStream&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>

    <span class="c1"># Leverages pygame to playback audio if playback argument is True.</span>
    <span class="k">if</span> <span class="n">playback</span><span class="p">:</span>
        <span class="n">pygame</span><span class="o">.</span><span class="n">mixer</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
        <span class="n">pygame</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
        <span class="n">sound</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">mixer</span><span class="o">.</span><span class="n">Sound</span><span class="p">(</span><span class="s1">&#39;MP3\OUTPUT.mp3&#39;</span><span class="p">)</span>
        <span class="n">sound_length</span> <span class="o">=</span> <span class="n">sound</span><span class="o">.</span><span class="n">get_length</span><span class="p">()</span>
        <span class="n">sound</span><span class="o">.</span><span class="n">play</span><span class="p">()</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">sound_length</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pdf_audio_main.PDF_Manipulation.create_text" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create_text</span><span class="p">(</span><span class="n">speech</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">playback</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Fetches text from PDF, outputs str on console and saves .txt file in location of filepath provided.</p>
<p>On user input for file path to pdf, create_text() fetches text from given pdf file path.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>speech</code></td>
          <td>
          </td>
          <td><p>Bool input if True method create_speech(text) will be executed using given text,
If false create_speech(text) will not be executed.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>playback</code></td>
          <td>
          </td>
          <td><p>Bool input used in nested method call create_speech() if True create_speech() will playback audio.
Else create_speech() will only save mp3 file to project folder location MP3.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>str</code>
          </td>
          <td><p>A string printed onto the console based on txt found in pdf file. It also saves a .txt file named</p></td>
        </tr>
        <tr>
          <td>
                <code>str</code>
          </td>
          <td><p>"input pdf"_Script to location Scripts.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>PDFtoAudio\pdf_audio_main.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">create_text</span><span class="p">(</span><span class="n">speech</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">playback</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">-&gt;</span><span class="nb">str</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Fetches text from PDF, outputs str on console and saves .txt file in location of filepath provided.</span>

<span class="sd">    On user input for file path to pdf, create_text() fetches text from given pdf file path.</span>

<span class="sd">    Args:</span>
<span class="sd">        speech:</span>
<span class="sd">            Bool input if True method create_speech(text) will be executed using given text,</span>
<span class="sd">            If false create_speech(text) will not be executed.</span>

<span class="sd">        playback:</span>
<span class="sd">            Bool input used in nested method call create_speech() if True create_speech() will playback audio.</span>
<span class="sd">            Else create_speech() will only save mp3 file to project folder location MP3.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A string printed onto the console based on txt found in pdf file. It also saves a .txt file named</span>
<span class="sd">        &quot;input pdf&quot;_Script to location Scripts.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># initialize pytesseract and pdf2image</span>
    <span class="n">poppler_path</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;C:\Program Files\poppler-0.68.0\bin&#39;</span>
    <span class="n">pytesseract</span><span class="o">.</span><span class="n">pytesseract</span><span class="o">.</span><span class="n">tesseract_cmd</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;C:\Program Files\Tesseract-OCR\tesseract.exe&#39;</span>


    <span class="n">filePath</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s1">&#39;Please provide file path to PDF location:&#39;</span><span class="p">)</span> <span class="c1"># User input for file path.</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;File Path provide: </span><span class="si">{</span><span class="n">filePath</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="n">images</span> <span class="o">=</span>  <span class="n">convert_from_path</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">filePath</span><span class="p">[:</span><span class="o">-</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s1">pdf&#39;</span><span class="p">,</span><span class="n">poppler_path</span><span class="o">=</span><span class="n">poppler_path</span><span class="p">)</span> <span class="c1">#converts pdf to image</span>

    <span class="n">text</span> <span class="o">=</span> <span class="n">pytesseract</span><span class="o">.</span><span class="n">image_to_string</span><span class="p">(</span><span class="n">images</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># extract text using pytesseract</span>

    <span class="c1"># Creates and opens a text file, writes extracted text and closes file in location.</span>
    <span class="c1"># Prints text script to console</span>
    <span class="n">text_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">filePath</span><span class="p">[:</span><span class="o">-</span><span class="mi">4</span><span class="p">]</span><span class="si">}</span><span class="s1">_Script.txt&#39;</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
    <span class="n">text_</span> <span class="o">=</span> <span class="n">text</span>
    <span class="n">text_</span> <span class="o">=</span> <span class="n">text_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">text_</span><span class="p">)</span>
    <span class="n">text_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">text</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">speech</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">playback</span><span class="p">:</span>
            <span class="n">PDF_Manipulation</span><span class="o">.</span><span class="n">create_speech</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="n">text</span><span class="p">,</span><span class="n">playback</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">PDF_Manipulation</span><span class="o">.</span><span class="n">create_speech</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="n">text</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>




  </div>

  </div>

</div>




              
            </article>
            
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="../reference/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Reference" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Reference
            </div>
          </div>
        </a>
      
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.ecf98df9.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.9c69f0bc.min.js"></script>
      
    
  </body>
</html>